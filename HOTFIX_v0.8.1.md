# 🐛 紧急修复：v0.8.1

## 问题描述

**v0.8.0 的图片识别功能未生效**

用户报告发送截图后没有自动识别效果，日志显示没有调用图片预处理服务。

## 问题原因

在 `ClaudeAgentService.ts` 中，用户消息被错误地转换为纯文本字符串，导致图片块信息丢失：

```typescript
// ❌ 错误代码（v0.8.0）
const content = messageContent.map((c: any) => c.text || '').join('');
// 只保留了文本，图片块被丢弃了！
```

## 修复方案

```typescript
// ✅ 修复后代码（v0.8.1）
const content = messageContent;
// 保留完整的内容块数组，包括图片块
```

## 影响范围

- **影响功能**：图片识别（GLM 视觉模型）
- **影响版本**：v0.8.0
- **修复版本**：v0.8.1
- **严重程度**：高（核心功能不可用）

## 升级建议

⚠️ **强烈建议升级到 v0.8.1！**

如果您已经安装了 v0.8.0，请立即升级到 v0.8.1 以获得图片识别功能。

## 测试验证

✅ **已测试场景**：
- 粘贴代码截图 → 自动识别
- 发送错误截图 → 自动诊断
- 拖拽图片文件 → 正常处理

## 文件信息

- **文件名**: `claude-dr-xiong-0.8.1.vsix`
- **大小**: 2.2 MB
- **发布日期**: 2025-01-19

## 安装方法

```bash
# 命令行安装
code --install-extension claude-dr-xiong-0.8.1.vsix

# 或在 VSCode 中
# 扩展 → ... → 从 VSIX 安装
```

---

**感谢您的反馈！这个问题现已修复。** 🎉
